<html>
    <head>
    <title>SSB-Msgs - Documentation - SSBC</title>
    <link rel="stylesheet" href="/normalize.css">
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet" href="/monokai.css">
    <script src="/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
    <body>
      <div id="topnav">
    <div id="topnav-inner">
      <a class="topnav-item " href="/" title="Home">
      Home<br><small>SSBC</small>
    </a>
      <a class="topnav-item " href="/patchwork" title="Patchwork">
      Patchwork<br><small>Messaging App</small>
    </a>
      <a class="topnav-item " href="/scuttlebot" title="Scuttlebot">
      Scuttlebot<br><small>P2P Database</small>
    </a>
      <a class="topnav-item selected" href="/docs" title="Documentation">
      Documentation<br><small>APIs, Tutorials, Whitepapers</small>
    </a>
    </div>
  </div>
      <div id="layout">
        <div id="leftnav">
      <div class="leftnav-item ">
      <a href="/secure-scuttlebutt" title="Secure Scuttlebutt">Secure Scuttlebutt<br><small>Database Protocol</small></a>
    </div>
      <div class="leftnav-subitems">
        <div class="leftnav-item ">
      <a href="/docs/ssb/learn.html" title="Learn about the Protocol">Learn about the Protocol</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/ssb/secret-handshake.html" title="Secret Handshake">Secret Handshake</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/ssb/end-to-end-encryption.html" title="End-to-end Encryption">End-to-end Encryption</a>
    </div>
      </div>
      <div class="leftnav-item">API Documentation</div>
      <div class="leftnav-subitems">
        <div class="leftnav-item ">
      <a href="/docs/api/scuttlebot.html" title="scuttlebot">scuttlebot</a>
    </div>
        <div class="leftnav-indent">
          <div class="leftnav-item ">
      <a href="/docs/api/scuttlebot-blobs.html" title="blobs">blobs</a>
    </div>
          <div class="leftnav-item ">
      <a href="/docs/api/scuttlebot-block.html" title="block">block</a>
    </div>
          <div class="leftnav-item ">
      <a href="/docs/api/scuttlebot-friends.html" title="friends">friends</a>
    </div>
          <div class="leftnav-item ">
      <a href="/docs/api/scuttlebot-gossip.html" title="gossip">gossip</a>
    </div>
          <div class="leftnav-item ">
      <a href="/docs/api/scuttlebot-invite.html" title="invite">invite</a>
    </div>
          <div class="leftnav-item ">
      <a href="/docs/api/scuttlebot-replicate.html" title="replicate">replicate</a>
    </div>
        </div>
        <div class="leftnav-item selected">
      <a href="/docs/api/ssb-msgs.html" title="ssb-msgs">ssb-msgs</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/api/ssb-msg-schemas.html" title="ssb-msg-schemas">ssb-msg-schemas</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/api/ssb-ref.html" title="ssb-ref">ssb-ref</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/api/ssb-keys.html" title="ssb-keys">ssb-keys</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/api/ssb-config.html" title="ssb-config">ssb-config</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/api/secret-stack.html" title="secret-stack">secret-stack</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/api/muxrpc.html" title="muxrpc">muxrpc</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/api/pull-stream.html" title="pull-stream">pull-stream</a>
    </div>
      </div>
      <div class="leftnav-item">Articles</div>
      <div class="leftnav-subitems">
        <div class="leftnav-item ">
      <a href="/docs/articles/design-challenge-avoid-centralization-and-singletons.html" title="Design Challenge: Avoiding Centralization and Singletons">Design Challenge: Avoiding Centralization and Singletons</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/articles/design-challenge-sybil-attack.html" title="Design Challenge: Sybil Attacks">Design Challenge: Sybil Attacks</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/articles/using-trust-in-open-networks.html" title="Using Trust in Open Networks">Using Trust in Open Networks</a>
    </div>
      </div>
    </div>
        <div id="content">
          <h1 id="ssb-messages">SSB Messages</h1>
<p>Message-processing tools for secure-scuttlebutt</p>
<pre><code class="lang-js">var mlib = require(&#39;ssb-msgs&#39;)
</code></pre>
<h3 id="indexlinks">indexLinks</h3>
<pre><code>indexLinks(msg: Object, [opts: Options], each: Function(link: Object, rel: String))
where Options = { rel: String, msg: Bool/String, feed: Bool/String, ext: Bool/String }
</code></pre><p>Traverses a message and runs the <code>each</code> function on all found links. All <code>opts</code> fields are optional. <code>Opts</code> may also be a string, in which case it is the rel attribute</p>
<pre><code class="lang-js">// assume %msgid and @feedid a well-formed
var msg = {
  foo: { link: &#39;%msgid&#39; },
  bar: [{ link: &#39;@feedid&#39; }]
}
function print (obj, rel) {
  console.log(rel, obj.link)  
}
mlib.indexLinks(msg, print)
// =&gt; foo %msgid
// =&gt; bar @feedid
mlib.indexLinks(msg, &#39;foo&#39;, print)
// =&gt; foo %msgid
mlib.indexLinks(msg, { rel: &#39;foo&#39; }, print)
// =&gt; foo %msgid
mlib.indexLinks(msg, { feed: true }, print)
// =&gt; bar @feedid
mlib.indexLinks(msg, { feed: &#39;@feedid&#39; }, print)
// =&gt; bar @feedid
</code></pre>
<h3 id="links-or-aslinks-">links (or asLinks)</h3>
<pre><code>links(obj: Any, [requiredAttr: String])
</code></pre><p>Helper to get links from a message in a regular array form.</p>
<pre><code class="lang-js">var msg = {
  foo: { link: &#39;%msgid&#39; },
  bar: [{ link: &#39;@feedid&#39; }]
}
mlib.links(msg.foo) // =&gt; [{ link: &#39;%msgid&#39; }]
mlib.links(msg.bar) // =&gt; [{ link: &#39;@feedid&#39; }]
mlib.links(msg.bar, &#39;feed&#39;) // =&gt; [{ link: &#39;@feedid&#39; }]
mlib.links(msg.bar, &#39;msg&#39;) // =&gt; []
mlib.links(msg.baz) // =&gt; []
</code></pre>
<h3 id="link-or-aslink-">link (or asLink)</h3>
<pre><code>link(obj: Any, [requiredAttr: String])
</code></pre><p>Helper to get a link from a message in a regular object form. If an array is found, will use the first element.</p>
<pre><code class="lang-js">var msg = {
  foo: { link: &#39;%msgid&#39; },
  bar: [{ link: &#39;@feedid&#39; }]
}
mlib.link(msg.foo) // =&gt; { link: &#39;%msgid&#39; }
mlib.link(msg.bar) // =&gt; { link: &#39;@feedid&#39; }
mlib.link(msg.bar, &#39;feed&#39;) // =&gt; { link: &#39;@feedid&#39; }
mlib.link(msg.bar, &#39;msg&#39;) // =&gt; null
mlib.link(msg.baz) // =&gt; null
</code></pre>
<h3 id="islink">isLink</h3>
<pre><code>isLink(obj: Any, [requiredAttr: String])
</code></pre><p>Predicate to test whether an object is a well-formed link. Returns false if given an array.</p>
<pre><code class="lang-js">var msg = {
  foo: { link: &#39;%msgid&#39; },
  bar: [{ link: &#39;@feedid&#39; }]
}
mlib.isLink(msg.foo) // =&gt; true
mlib.isLink(msg.bar) // =&gt; true
mlib.isLink(msg.bar, &#39;feed&#39;) // =&gt; true
mlib.isLink(msg.bar, &#39;msg&#39;) // =&gt; false
mlib.isLink(msg.baz) // =&gt; false
</code></pre>
<h3 id="linksto">linksTo</h3>
<pre><code>linksTo(a: Message, b: Message)
</code></pre><p>Get link objects pointing from <code>a</code> to <code>b</code>.</p>
<pre><code class="lang-js">mlib.linksTo(msgA, msgB) // =&gt; [{ link: &#39;%msgB-id&#39; }]
</code></pre>
<h3 id="relationsto">relationsTo</h3>
<pre><code>relationsTo(a: Message, b: Message)
</code></pre><p>Get relations of links pointing from <code>a</code> to <code>b</code>.</p>
<pre><code class="lang-js">mlib.relationsTo(msgA, msgB) // =&gt; [&#39;fooRelation&#39;]
</code></pre>

        </div>
      </div>
    </body>
  </html>